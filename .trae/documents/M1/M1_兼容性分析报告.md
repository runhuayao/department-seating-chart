# M1é˜¶æ®µå…¼å®¹æ€§åˆ†ææŠ¥å‘Š

***

**æ–‡æ¡£ç‰ˆæœ¬**: M1.1.0\
**åˆ›å»ºæ—¥æœŸ**: 2025-9-7\
**åˆ†æèŒƒå›´**: M0â†’M1â†’M2ç‰ˆæœ¬å‡çº§å…¼å®¹æ€§\
**åˆ†æç»“è®º**: æ€»ä½“å…¼å®¹ï¼Œå­˜åœ¨éƒ¨åˆ†é£é™©ç‚¹éœ€è¦å¤„ç†

***

## 1. å…¼å®¹æ€§åˆ†ææ¦‚è¿°

### 1.1 åˆ†æç›®æ ‡

æœ¬æŠ¥å‘Šå…¨é¢åˆ†æM1é˜¶æ®µæŠ€æœ¯æ–‡æ¡£ä¸M0ç‰ˆæœ¬ç°æœ‰ä»£ç çš„å…¼å®¹æ€§ï¼Œç¡®ä¿ç‰ˆæœ¬å‡çº§è¿‡ç¨‹çš„å¹³æ»‘æ€§å’Œç³»ç»Ÿç¨³å®šæ€§ã€‚é‡ç‚¹éªŒè¯æ¥å£è§„èŒƒã€æ•°æ®ç»“æ„ã€éƒ¨ç½²æµç¨‹å’Œç‰ˆæœ¬ç®¡ç†æœºåˆ¶çš„å…¼å®¹æ€§è®¾è®¡ã€‚

### 1.2 åˆ†ææ–¹æ³•

* **é™æ€åˆ†æ**: å¯¹æ¯”M0æºç ä¸M1æ–‡æ¡£ä¸­çš„æ¥å£å®šä¹‰

* **æ•°æ®ç»“æ„å¯¹æ¯”**: åˆ†æç°æœ‰æ•°æ®æ¨¡å‹ä¸M1æ•°æ®åº“è®¾è®¡çš„å…¼å®¹æ€§

* **æ¶æ„æ¼”è¿›åˆ†æ**: è¯„ä¼°ä»å‰ç«¯å•ä½“åˆ°å‰åç«¯åˆ†ç¦»çš„è¿ç§»è·¯å¾„

* **é£é™©è¯„ä¼°**: è¯†åˆ«æ½œåœ¨çš„å…¼å®¹æ€§é£é™©ç‚¹å’Œè§£å†³æ–¹æ¡ˆ

### 1.3 å…¼å®¹æ€§ç­‰çº§å®šä¹‰

* **âœ… å®Œå…¨å…¼å®¹**: æ— éœ€ä¿®æ”¹å³å¯ç›´æ¥ä½¿ç”¨

* **âš ï¸ éƒ¨åˆ†å…¼å®¹**: éœ€è¦é€‚é…å±‚æˆ–è½»å¾®ä¿®æ”¹

* **âŒ ä¸å…¼å®¹**: éœ€è¦é‡æ„æˆ–é‡æ–°è®¾è®¡

* **ğŸ”„ éœ€è¦è¿ç§»**: éœ€è¦æ•°æ®è¿ç§»æˆ–æ ¼å¼è½¬æ¢

## 2. æ¥å£å…¼å®¹æ€§åˆ†æ

### 2.1 æ•°æ®ç»“æ„å…¼å®¹æ€§

#### M0ç°æœ‰æ•°æ®ç»“æ„

```typescript
// M0ç‰ˆæœ¬ - departmentData.ts
interface Employee {
  employee_id: number;
  name: string;
  department: string;
  status: 'online' | 'offline';
}

interface Desk {
  desk_id: string;
  x: number;
  y: number;
  w: number;
  h: number;
  label: string;
  employee_id?: number;
  department: string;
}
```

#### M1ç›®æ ‡æ•°æ®ç»“æ„

```typescript
// M1ç‰ˆæœ¬ - APIæ¥å£å®šä¹‰
interface Employee {
  id: number;              // âŒ å­—æ®µåå˜æ›´: employee_id â†’ id
  name: string;            // âœ… å®Œå…¨å…¼å®¹
  deptId: number;          // âŒ å­—æ®µå˜æ›´: department(string) â†’ deptId(number)
  title?: string;          // âœ… æ–°å¢å­—æ®µï¼Œå¯é€‰
  email?: string;          // âœ… æ–°å¢å­—æ®µï¼Œå¯é€‰
  phone?: string;          // âœ… æ–°å¢å­—æ®µï¼Œå¯é€‰
  createdAt: Date;         // âœ… æ–°å¢å­—æ®µ
  updatedAt: Date;         // âœ… æ–°å¢å­—æ®µ
}

interface Desk {
  id: string;              // âŒ å­—æ®µåå˜æ›´: desk_id â†’ id
  label: string;           // âœ… å®Œå…¨å…¼å®¹
  deptId: number;          // âŒ å­—æ®µå˜æ›´: department(string) â†’ deptId(number)
  x: number;               // âœ… å®Œå…¨å…¼å®¹
  y: number;               // âœ… å®Œå…¨å…¼å®¹
  w: number;               // âœ… å®Œå…¨å…¼å®¹
  h: number;               // âœ… å®Œå…¨å…¼å®¹
  createdAt: Date;         // âœ… æ–°å¢å­—æ®µ
}
```

**å…¼å®¹æ€§è¯„ä¼°**: âš ï¸ éƒ¨åˆ†å…¼å®¹

**é£é™©ç‚¹**:

1. å­—æ®µåç§°å˜æ›´å¯èƒ½å¯¼è‡´å‰ç«¯ç»„ä»¶æŠ¥é”™
2. éƒ¨é—¨æ ‡è¯†ä»å­—ç¬¦ä¸²æ”¹ä¸ºæ•°å­—IDéœ€è¦æ˜ å°„å…³ç³»
3. å‘˜å·¥ä¸å·¥ä½çš„å…³è”å…³ç³»éœ€è¦é€šè¿‡æ–°çš„Assignmentè¡¨ç®¡ç†

### 2.2 APIæ¥å£å…¼å®¹æ€§

#### M0å‰ç«¯æ•°æ®è·å–æ–¹å¼

```typescript
// M0ç‰ˆæœ¬ - ç›´æ¥å¯¼å…¥é™æ€æ•°æ®
import { 
  getDepartmentConfig, 
  getEmployeeById, 
  getDesksByDepartment 
} from '../data/departmentData';
```

#### M1 APIæ¥å£è®¾è®¡

```typescript
// M1ç‰ˆæœ¬ - RESTful API
GET /api/desks/by-dept/:deptId     // è·å–éƒ¨é—¨å·¥ä½
GET /api/employees/:id             // è·å–å‘˜å·¥ä¿¡æ¯
GET /api/employees/search          // æœç´¢å‘˜å·¥
POST /api/status/heartbeat         // å¿ƒè·³ä¸ŠæŠ¥
```

**å…¼å®¹æ€§è¯„ä¼°**: ğŸ”„ éœ€è¦è¿ç§»

**è¿ç§»ç­–ç•¥**:

1. åˆ›å»ºé€‚é…å±‚å‡½æ•°ï¼Œä¿æŒM0ç»„ä»¶æ¥å£ä¸å˜
2. é€æ­¥æ›¿æ¢é™æ€æ•°æ®è°ƒç”¨ä¸ºAPIè°ƒç”¨
3. å®ç°æ•°æ®ç¼“å­˜æœºåˆ¶ï¼Œå‡å°‘APIè°ƒç”¨é¢‘æ¬¡

### 2.3 ç»„ä»¶æ¥å£å…¼å®¹æ€§

#### DeptMapç»„ä»¶æ¥å£åˆ†æ

```typescript
// M0ç‰ˆæœ¬ç»„ä»¶æ¥å£
interface DeptMapProps {
  department: string;      // âœ… ä¿æŒå…¼å®¹
  searchQuery?: string;    // âœ… ä¿æŒå…¼å®¹
  isHomepage?: boolean;    // âœ… ä¿æŒå…¼å®¹
}
```

**å…¼å®¹æ€§è¯„ä¼°**: âœ… å®Œå…¨å…¼å®¹

**è¯´æ˜**: M1é˜¶æ®µä¿æŒç»„ä»¶æ¥å£ä¸å˜ï¼Œä»…åœ¨å†…éƒ¨å®ç°ä¸Šä»é™æ€æ•°æ®åˆ‡æ¢åˆ°APIè°ƒç”¨ã€‚

## 3. æ•°æ®åº“å…¼å®¹æ€§åˆ†æ

### 3.1 æ•°æ®è¿ç§»æ˜ å°„

#### éƒ¨é—¨æ•°æ®è¿ç§»

```sql
-- M0é™æ€æ•°æ® â†’ M1æ•°æ®åº“è¡¨
INSERT INTO departments (id, name, floor, map_id) VALUES
(1, 'Engineering', '2F', 'eng_floor_2'),
(2, 'Marketing', '3F', 'mkt_floor_3'),
(3, 'Sales', '4F', 'sales_floor_4'),
(4, 'HR', '5F', 'hr_floor_5');
```

#### å‘˜å·¥æ•°æ®è¿ç§»

```sql
-- å‘˜å·¥æ•°æ®è¿ç§»è„šæœ¬
INSERT INTO employees (id, name, dept_id, created_at) 
SELECT 
  employee_id as id,
  name,
  CASE department
    WHEN 'Engineering' THEN 1
    WHEN 'Marketing' THEN 2
    WHEN 'Sales' THEN 3
    WHEN 'HR' THEN 4
  END as dept_id,
  NOW() as created_at
FROM m0_employee_data;
```

#### å·¥ä½æ•°æ®è¿ç§»

```sql
-- å·¥ä½æ•°æ®è¿ç§»è„šæœ¬
INSERT INTO desks (id, label, dept_id, x, y, w, h, created_at)
SELECT 
  desk_id as id,
  label,
  CASE department
    WHEN 'Engineering' THEN 1
    WHEN 'Marketing' THEN 2
    WHEN 'Sales' THEN 3
    WHEN 'HR' THEN 4
  END as dept_id,
  x, y, w, h,
  NOW() as created_at
FROM m0_desk_data;
```

**å…¼å®¹æ€§è¯„ä¼°**: ğŸ”„ éœ€è¦è¿ç§»

**è¿ç§»ä¿éšœ**:

1. æä¾›å®Œæ•´çš„æ•°æ®è¿ç§»è„šæœ¬
2. å®ç°æ•°æ®éªŒè¯å’Œå›æ»šæœºåˆ¶
3. ä¿æŒåŸæœ‰æ•°æ®çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§

### 3.2 æ•°æ®ä¸€è‡´æ€§ä¿è¯

#### é€»è¾‘å¤–é”®è®¾è®¡

```sql
-- M1é‡‡ç”¨é€»è¾‘å¤–é”®ï¼Œé¿å…ç‰©ç†çº¦æŸ
-- è¿™æ ·å¯ä»¥ä¿è¯æ•°æ®è¿ç§»çš„çµæ´»æ€§
CREATE TABLE assignments (
    id SERIAL PRIMARY KEY,
    employee_id INTEGER NOT NULL,  -- é€»è¾‘å¤–é”®
    desk_id VARCHAR(50) NOT NULL,  -- é€»è¾‘å¤–é”®
    active BOOLEAN DEFAULT true,
    assigned_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- é€šè¿‡åº”ç”¨å±‚ä¿è¯æ•°æ®ä¸€è‡´æ€§
-- è€Œä¸æ˜¯æ•°æ®åº“å±‚é¢çš„ç‰©ç†å¤–é”®çº¦æŸ
```

**å…¼å®¹æ€§ä¼˜åŠ¿**:

1. æ•°æ®è¿ç§»è¿‡ç¨‹ä¸­ä¸ä¼šå› ä¸ºå¤–é”®çº¦æŸå¤±è´¥
2. æ”¯æŒæ¸è¿›å¼æ•°æ®è¿ç§»å’ŒéªŒè¯
3. ä¾¿äºåç»­M2é˜¶æ®µçš„å¾®æœåŠ¡æ‹†åˆ†

## 4. éƒ¨ç½²æµç¨‹å…¼å®¹æ€§åˆ†æ

### 4.1 M0åˆ°M1éƒ¨ç½²å‡çº§è·¯å¾„

#### å½“å‰M0éƒ¨ç½²æ–¹å¼

```bash
# M0ç‰ˆæœ¬ - çº¯å‰ç«¯éƒ¨ç½²
npm run build
# é™æ€æ–‡ä»¶éƒ¨ç½²åˆ°WebæœåŠ¡å™¨
```

#### M1éƒ¨ç½²å‡çº§æ­¥éª¤

```bash
# Step 1: ä¿æŒM0å‰ç«¯è¿è¡Œï¼Œéƒ¨ç½²M1åç«¯æœåŠ¡
docker-compose up -d postgres redis
npm run migrate:deploy
npm run seed:initial

# Step 2: å¯åŠ¨APIæœåŠ¡
PM2_HOME=/opt/pm2 pm2 start ecosystem.config.js

# Step 3: æ›´æ–°å‰ç«¯é…ç½®ï¼Œå¯ç”¨APIè°ƒç”¨
# é€šè¿‡ç¯å¢ƒå˜é‡æ§åˆ¶æ˜¯å¦ä½¿ç”¨API
REACT_APP_USE_API=true npm run build

# Step 4: éªŒè¯ç³»ç»ŸåŠŸèƒ½æ­£å¸¸
curl http://localhost:3000/api/health

# Step 5: åˆ‡æ¢æµé‡åˆ°æ–°ç‰ˆæœ¬
nginx -s reload
```

**å…¼å®¹æ€§è¯„ä¼°**: âš ï¸ éƒ¨åˆ†å…¼å®¹

**é£é™©æ§åˆ¶**:

1. è“ç»¿éƒ¨ç½²ç­–ç•¥ï¼Œç¡®ä¿å¯å¿«é€Ÿå›æ»š
2. æ•°æ®åº“è¿ç§»å‰è¿›è¡Œå®Œæ•´å¤‡ä»½
3. åˆ†é˜¶æ®µåˆ‡æ¢ï¼Œå…ˆåˆ‡æ¢éƒ¨åˆ†æµé‡éªŒè¯

### 4.2 å›æ»šæœºåˆ¶è®¾è®¡

```bash
# å¿«é€Ÿå›æ»šåˆ°M0ç‰ˆæœ¬
#!/bin/bash
set -e

echo "å¼€å§‹å›æ»šåˆ°M0ç‰ˆæœ¬..."

# 1. åœæ­¢M1 APIæœåŠ¡
pm2 stop all

# 2. æ¢å¤M0å‰ç«¯é…ç½®
cp /backup/m0-build/* /var/www/html/

# 3. é‡å¯Nginx
nginx -s reload

# 4. éªŒè¯M0åŠŸèƒ½
curl -f http://localhost/ || exit 1

echo "å›æ»šå®Œæˆï¼Œç³»ç»Ÿå·²æ¢å¤åˆ°M0ç‰ˆæœ¬"
```

## 5. ç‰ˆæœ¬ç®¡ç†å…¼å®¹æ€§åˆ†æ

### 5.1 M0â†’M1â†’M2è¿ç§»è·¯å¾„éªŒè¯

æ ¹æ®`M1_å®æ–½æ–¹æ¡ˆæ–‡æ¡£.md`ç¬¬413-432è¡Œçš„è®¾è®¡ï¼š

```mermaid
graph TD
    subgraph "M0 å½“å‰æ¶æ„"
        A0[Reactå‰ç«¯ + é™æ€æ•°æ®]
    end
    
    subgraph "M1 è¿‡æ¸¡æ¶æ„"
        A1[Reactå‰ç«¯] --> B1[Express API]
        B1 --> C1[PostgreSQL]
        B1 --> D1[Redis]
    end
    
    subgraph "M2 ç›®æ ‡æ¶æ„"
        A2[Reactå‰ç«¯] --> B2[APIç½‘å…³]
        B2 --> C2[è®¤è¯æœåŠ¡]
        B2 --> D2[ä¸šåŠ¡æœåŠ¡é›†ç¾¤]
    end
    
    A0 -.->|æ¸è¿›å¼è¿ç§»| A1
    A1 -.->|æœåŠ¡æ‹†åˆ†| A2
```

**å…¼å®¹æ€§è¯„ä¼°**: âœ… å®Œå…¨å…¼å®¹

**è¿ç§»ä¿éšœ**:

1. M1é˜¶æ®µä¿æŒå‰ç«¯ç»„ä»¶æ¥å£ä¸å˜
2. é€šè¿‡é€‚é…å±‚å®ç°å¹³æ»‘è¿‡æ¸¡
3. APIç‰ˆæœ¬æ§åˆ¶æ”¯æŒæ¸è¿›å¼å‡çº§
4. æ•°æ®åº“è®¾è®¡è€ƒè™‘M2å¾®æœåŠ¡æ‹†åˆ†éœ€æ±‚

### 5.2 APIç‰ˆæœ¬æ§åˆ¶ç­–ç•¥

```typescript
// ç‰ˆæœ¬æ§åˆ¶å®ç°
app.use('/api/v1', v1Routes);  // M1 API
app.use('/api/v2', v2Routes);  // M2 API (å‘åå…¼å®¹)

// æ¸è¿›å¼è¿ç§»é…ç½®
const routeConfig = {
  '/desks': { version: 'v1', service: 'monolith' },
  '/employees': { version: 'v1', service: 'monolith' },
  '/status': { version: 'v1', service: 'monolith' }
};

// M2é˜¶æ®µå¯ä»¥é€æ­¥åˆ‡æ¢åˆ°å¾®æœåŠ¡
const routeConfigM2 = {
  '/desks': { version: 'v2', service: 'desk-service' },
  '/employees': { version: 'v2', service: 'employee-service' },
  '/status': { version: 'v2', service: 'status-service' }
};
```

## 6. é£é™©è¯„ä¼°ä¸è§£å†³æ–¹æ¡ˆ

### 6.1 é«˜é£é™©é¡¹

| é£é™©é¡¹         | é£é™©ç­‰çº§ | å½±å“èŒƒå›´  | è§£å†³æ–¹æ¡ˆ           |
| ----------- | ---- | ----- | -------------- |
| æ•°æ®ç»“æ„å­—æ®µåå˜æ›´   | ğŸ”´ é«˜ | å‰ç«¯ç»„ä»¶  | åˆ›å»ºé€‚é…å±‚ï¼Œä¿æŒå‘åå…¼å®¹   |
| éƒ¨é—¨IDç±»å‹å˜æ›´    | ğŸ”´ é«˜ | æ•°æ®å…³è”  | æä¾›æ˜ å°„è¡¨å’Œè½¬æ¢å‡½æ•°     |
| APIè°ƒç”¨æ›¿æ¢é™æ€æ•°æ® | ğŸŸ¡ ä¸­ | æ•°æ®è·å–  | æ¸è¿›å¼æ›¿æ¢ï¼Œä¿ç•™é™çº§æœºåˆ¶   |
| æ•°æ®åº“è¿ç§»å¤±è´¥     | ğŸ”´ é«˜ | ç³»ç»Ÿå¯ç”¨æ€§ | å®Œæ•´å¤‡ä»½+è¿ç§»éªŒè¯+å›æ»šæœºåˆ¶ |

### 6.2 è§£å†³æ–¹æ¡ˆè¯¦ç»†è®¾è®¡

#### 6.2.1 æ•°æ®é€‚é…å±‚å®ç°

```typescript
// src/adapters/dataAdapter.ts
// ä¸ºM0ç»„ä»¶æä¾›å…¼å®¹çš„æ•°æ®æ¥å£

export class DataAdapter {
  // é€‚é…å‘˜å·¥æ•°æ®æ ¼å¼
  static adaptEmployee(m1Employee: M1Employee): M0Employee {
    return {
      employee_id: m1Employee.id,
      name: m1Employee.name,
      department: this.getDepartmentName(m1Employee.deptId),
      status: m1Employee.status || 'offline'
    };
  }
  
  // é€‚é…å·¥ä½æ•°æ®æ ¼å¼
  static adaptDesk(m1Desk: M1Desk, assignment?: Assignment): M0Desk {
    return {
      desk_id: m1Desk.id,
      x: m1Desk.x,
      y: m1Desk.y,
      w: m1Desk.w,
      h: m1Desk.h,
      label: m1Desk.label,
      employee_id: assignment?.employeeId,
      department: this.getDepartmentName(m1Desk.deptId)
    };
  }
  
  // éƒ¨é—¨IDåˆ°åç§°çš„æ˜ å°„
  private static getDepartmentName(deptId: number): string {
    const mapping = {
      1: 'Engineering',
      2: 'Marketing', 
      3: 'Sales',
      4: 'HR'
    };
    return mapping[deptId] || 'Unknown';
  }
}
```

#### 6.2.2 æ¸è¿›å¼APIè¿ç§»

```typescript
// src/services/dataService.ts
// æ”¯æŒé™æ€æ•°æ®å’ŒAPIæ•°æ®çš„æ··åˆä½¿ç”¨

export class DataService {
  private useAPI = process.env.REACT_APP_USE_API === 'true';
  
  async getDepartmentConfig(department: string): Promise<DepartmentConfig> {
    if (this.useAPI) {
      try {
        // å°è¯•ä»APIè·å–æ•°æ®
        const response = await fetch(`/api/departments/${department}`);
        const data = await response.json();
        return DataAdapter.adaptDepartmentConfig(data);
      } catch (error) {
        console.warn('APIè°ƒç”¨å¤±è´¥ï¼Œé™çº§åˆ°é™æ€æ•°æ®:', error);
        // é™çº§åˆ°é™æ€æ•°æ®
        return this.getStaticDepartmentConfig(department);
      }
    } else {
      // ä½¿ç”¨é™æ€æ•°æ®
      return this.getStaticDepartmentConfig(department);
    }
  }
  
  private getStaticDepartmentConfig(department: string): DepartmentConfig {
    // åŸæœ‰çš„é™æ€æ•°æ®è·å–é€»è¾‘
    return getDepartmentConfig(department);
  }
}
```

#### 6.2.3 æ•°æ®è¿ç§»éªŒè¯æœºåˆ¶

```sql
-- æ•°æ®è¿ç§»éªŒè¯è„šæœ¬
-- éªŒè¯å‘˜å·¥æ•°æ®å®Œæ•´æ€§
SELECT 
  'employees' as table_name,
  COUNT(*) as migrated_count,
  (SELECT COUNT(*) FROM m0_employee_data) as original_count,
  CASE 
    WHEN COUNT(*) = (SELECT COUNT(*) FROM m0_employee_data) 
    THEN 'PASS' 
    ELSE 'FAIL' 
  END as validation_result
FROM employees;

-- éªŒè¯å·¥ä½æ•°æ®å®Œæ•´æ€§
SELECT 
  'desks' as table_name,
  COUNT(*) as migrated_count,
  (SELECT COUNT(*) FROM m0_desk_data) as original_count,
  CASE 
    WHEN COUNT(*) = (SELECT COUNT(*) FROM m0_desk_data) 
    THEN 'PASS' 
    ELSE 'FAIL' 
  END as validation_result
FROM desks;

-- éªŒè¯æ•°æ®å…³è”å…³ç³»
SELECT 
  'assignments' as table_name,
  COUNT(*) as assignment_count,
  (SELECT COUNT(*) FROM m0_desk_data WHERE employee_id IS NOT NULL) as expected_count,
  CASE 
    WHEN COUNT(*) = (SELECT COUNT(*) FROM m0_desk_data WHERE employee_id IS NOT NULL) 
    THEN 'PASS' 
    ELSE 'FAIL' 
  END as validation_result
FROM assignments WHERE active = true;
```

## 7. å…¼å®¹æ€§æµ‹è¯•è®¡åˆ’

### 7.1 æµ‹è¯•èŒƒå›´

1. **æ¥å£å…¼å®¹æ€§æµ‹è¯•**

   * M0ç»„ä»¶åœ¨M1ç¯å¢ƒä¸‹çš„åŠŸèƒ½éªŒè¯

   * APIå“åº”æ ¼å¼ä¸M0æ•°æ®ç»“æ„çš„å…¼å®¹æ€§

   * é”™è¯¯å¤„ç†å’Œé™çº§æœºåˆ¶æµ‹è¯•

2. **æ•°æ®è¿ç§»æµ‹è¯•**

   * æ•°æ®å®Œæ•´æ€§éªŒè¯

   * æ•°æ®å…³è”å…³ç³»æ­£ç¡®æ€§

   * è¿ç§»æ€§èƒ½æµ‹è¯•

3. **éƒ¨ç½²å‡çº§æµ‹è¯•**

   * è“ç»¿éƒ¨ç½²æµç¨‹éªŒè¯

   * å›æ»šæœºåˆ¶æµ‹è¯•

   * æœåŠ¡å¯ç”¨æ€§æµ‹è¯•

### 7.2 æµ‹è¯•ç”¨ä¾‹

```typescript
// å…¼å®¹æ€§æµ‹è¯•ç”¨ä¾‹ç¤ºä¾‹
describe('M0-M1å…¼å®¹æ€§æµ‹è¯•', () => {
  test('DeptMapç»„ä»¶åœ¨M1ç¯å¢ƒä¸‹æ­£å¸¸æ¸²æŸ“', async () => {
    const { render } = renderWithAPI();
    const component = render(<DeptMap department="Engineering" />);
    
    // éªŒè¯ç»„ä»¶æ­£å¸¸æ¸²æŸ“
    expect(component.getByText('å·¥ç¨‹éƒ¨ éƒ¨é—¨åœ°å›¾')).toBeInTheDocument();
    
    // éªŒè¯å·¥ä½æ•°æ®æ­£ç¡®æ˜¾ç¤º
    await waitFor(() => {
      expect(component.getByText('E01')).toBeInTheDocument();
      expect(component.getByText('å¼ ä¸‰')).toBeInTheDocument();
    });
  });
  
  test('æ•°æ®é€‚é…å±‚æ­£ç¡®è½¬æ¢M1æ•°æ®æ ¼å¼', () => {
    const m1Employee = {
      id: 1001,
      name: 'å¼ ä¸‰',
      deptId: 1,
      title: 'å‰ç«¯å·¥ç¨‹å¸ˆ'
    };
    
    const m0Employee = DataAdapter.adaptEmployee(m1Employee);
    
    expect(m0Employee).toEqual({
      employee_id: 1001,
      name: 'å¼ ä¸‰',
      department: 'Engineering',
      status: 'offline'
    });
  });
});
```

## 8. æ€»ç»“ä¸å»ºè®®

### 8.1 å…¼å®¹æ€§æ€»ä½“è¯„ä¼°

| å…¼å®¹æ€§ç»´åº¦   | è¯„ä¼°ç»“æœ    | é£é™©ç­‰çº§  | å¤„ç†çŠ¶æ€      |
| ------- | ------- | ----- | --------- |
| æ¥å£è§„èŒƒå…¼å®¹æ€§ | âš ï¸ éƒ¨åˆ†å…¼å®¹ | ğŸŸ¡ ä¸­ç­‰ | âœ… å·²è®¾è®¡é€‚é…å±‚  |
| æ•°æ®ç»“æ„å…¼å®¹æ€§ | ğŸ”„ éœ€è¦è¿ç§» | ğŸ”´ é«˜  | âœ… å·²æä¾›è¿ç§»æ–¹æ¡ˆ |
| éƒ¨ç½²æµç¨‹å…¼å®¹æ€§ | âš ï¸ éƒ¨åˆ†å…¼å®¹ | ğŸŸ¡ ä¸­ç­‰ | âœ… å·²è®¾è®¡å‡çº§è·¯å¾„ |
| ç‰ˆæœ¬ç®¡ç†å…¼å®¹æ€§ | âœ… å®Œå…¨å…¼å®¹  | ğŸŸ¢ ä½  | âœ… è®¾è®¡å®Œå–„    |

### 8.2 å…³é”®æˆåŠŸå› ç´ 

1. **é€‚é…å±‚è®¾è®¡**: é€šè¿‡æ•°æ®é€‚é…å±‚ä¿æŒM0ç»„ä»¶æ¥å£ä¸å˜
2. **æ¸è¿›å¼è¿ç§»**: æ”¯æŒAPIå’Œé™æ€æ•°æ®çš„æ··åˆä½¿ç”¨
3. **å®Œæ•´çš„å›æ»šæœºåˆ¶**: ç¡®ä¿å‡çº§å¤±è´¥æ—¶å¯å¿«é€Ÿæ¢å¤
4. **æ•°æ®è¿ç§»éªŒè¯**: ä¿è¯æ•°æ®å®Œæ•´æ€§å’Œä¸€è‡´æ€§
5. **ç‰ˆæœ¬æ§åˆ¶ç­–ç•¥**: ä¸ºM2é˜¶æ®µé¢„ç•™æ‰©å±•ç©ºé—´

### 8.3 å®æ–½å»ºè®®

1. **ä¼˜å…ˆçº§æ’åº**:

   * P0: æ•°æ®é€‚é…å±‚å®ç°

   * P1: æ•°æ®è¿ç§»è„šæœ¬å¼€å‘å’Œæµ‹è¯•

   * P2: éƒ¨ç½²å‡çº§æµç¨‹éªŒè¯

   * P3: ç›‘æ§å’Œå‘Šè­¦æœºåˆ¶å®Œå–„

2. **é£é™©ç¼“è§£æªæ–½**:

   * åœ¨æµ‹è¯•ç¯å¢ƒå®Œæ•´éªŒè¯æ‰€æœ‰å…¼å®¹æ€§åœºæ™¯

   * å‡†å¤‡è¯¦ç»†çš„åº”æ€¥é¢„æ¡ˆå’Œå›æ»šæµç¨‹

   * å®æ–½åˆ†é˜¶æ®µä¸Šçº¿ï¼Œå…ˆå°èŒƒå›´éªŒè¯

   * å»ºç«‹å®æ—¶ç›‘æ§ï¼ŒåŠæ—¶å‘ç°é—®é¢˜

3. **åç»­ä¼˜åŒ–æ–¹å‘**:

   * é€æ­¥ç§»é™¤é€‚é…å±‚ï¼Œç›´æ¥ä½¿ç”¨M1æ•°æ®æ ¼å¼

   * ä¼˜åŒ–APIæ€§èƒ½ï¼Œå‡å°‘å“åº”æ—¶é—´

   * å®Œå–„ç¼“å­˜æœºåˆ¶ï¼Œæå‡ç”¨æˆ·ä½“éªŒ

   * ä¸ºM2å¾®æœåŠ¡æ¶æ„åšå¥½å‡†å¤‡

### 8.4 éªŒæ”¶æ ‡å‡†

* [ ] M0æ‰€æœ‰åŠŸèƒ½åœ¨M1ç¯å¢ƒä¸‹æ­£å¸¸è¿è¡Œ

* [ ] æ•°æ®è¿ç§»æˆåŠŸç‡100%ï¼Œæ— æ•°æ®ä¸¢å¤±

* [ ] éƒ¨ç½²å‡çº§è¿‡ç¨‹æœåŠ¡ä¸­æ–­æ—¶é—´<5åˆ†é’Ÿ

* [ ] å›æ»šæœºåˆ¶éªŒè¯é€šè¿‡ï¼Œå¯åœ¨2åˆ†é’Ÿå†…å®Œæˆå›æ»š

* [ ] æ€§èƒ½æŒ‡æ ‡ä¸ä½äºM0ç‰ˆæœ¬æ°´å¹³

* [ ] æ‰€æœ‰å…¼å®¹æ€§æµ‹è¯•ç”¨ä¾‹é€šè¿‡

***

**ç»“è®º**: M1é˜¶æ®µçš„æŠ€æœ¯æ–‡æ¡£è®¾è®¡æ€»ä½“ä¸Šä¸M0ç‰ˆæœ¬å…¼å®¹ï¼Œé€šè¿‡é€‚é…å±‚ã€æ•°æ®è¿ç§»å’Œæ¸è¿›å¼å‡çº§ç­–ç•¥ï¼Œå¯ä»¥å®ç°å¹³æ»‘çš„ç‰ˆæœ¬è¿‡æ¸¡ã€‚å…³é”®åœ¨äºä¸¥æ ¼æŒ‰ç…§å…¼å®¹æ€§è®¾è®¡æ‰§è¡Œå®æ–½ï¼Œå¹¶åšå¥½å……åˆ†çš„æµ‹è¯•éªŒè¯ã€‚
